
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2.2.1. pywhy_stats.conditional_ksample.kcd &#8212; pywhy-stats v0.2.dev0</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples and Tutorials using pywhy-stats" href="../use.html" />
    <link rel="prev" title="2.3.1. pywhy_stats.conditional_ksample.bregman" href="pywhy_stats.conditional_ksample.bregman.html" />
    <link rel="canonical" href="https://www.pywhy.org/pywhy-stats/stable/index.html" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/scrollfix.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">pywhy-stats v0.2.dev0</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  Reference API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../use.html">
  Simple Examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../user_guide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../whats_new.html">
  Release History
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://raw.githubusercontent.com/py-why/pywhy-stats/main/LICENSE">
  License
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference external nav-link" href="https://github.com/py-why/pywhy-stats/blob/main/CONTRIBUTING.md">
  Contributing
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
        v
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action py-1" href="https://www.pywhy.org/pywhy-stats/dev/index.html">v0.2 (devel)</a>
        <a class="list-group-item list-group-item-action py-1" href="https://www.pywhy.org/pywhy-stats/stable/index.html">v0.1 (stable)</a>
        <a class="list-group-item list-group-item-action py-1" href="https://www.pywhy.org/pywhy-stats/v0.1/index.html">v0.1</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pywhy/pywhy-stats" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../conditional_independence.html">
   1. Independence
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pywhy_stats.independence.fisherz.html">
     1.2.1. pywhy_stats.independence.fisherz
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pywhy_stats.independence.power_divergence.html">
     1.3.1. pywhy_stats.independence.power_divergence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pywhy_stats.independence.kci.html">
     1.4.1. pywhy_stats.independence.kci
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#returns">
   2.2.1.1. Returns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pywhy_stats.conditional_ksample.kcd.condind">
   <code class="docutils literal notranslate">
    <span class="pre">
     condind()
    </span>
   </code>
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="module-pywhy_stats.conditional_ksample.kcd">
<span id="pywhy-stats-conditional-ksample-kcd"></span><h1><span class="section-number">2.2.1. </span>pywhy_stats.conditional_ksample.kcd<a class="headerlink" href="#module-pywhy_stats.conditional_ksample.kcd" title="Permalink to this heading">#</a></h1>
<p>Kernel (conditional) discrepancy test.</p>
<p>Also known as a conditional k-sample test, where the null hypothesis is that the
conditional distributions are equal across different population groups.</p>
<section id="returns">
<h2><span class="section-number">2.2.1.1. </span>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">#</a></h2>
<dl class="simple">
<dt>PValueResult</dt><dd><p>The result of the test, which includes the test statistic and pvalue.</p>
</dd>
</dl>
</section>
<p class="rubric">Functions</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pywhy_stats.conditional_ksample.kcd.condind" title="pywhy_stats.conditional_ksample.kcd.condind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">condind</span></code></a>(X, Y, group_ind[, kernel_X, ...])</p></td>
<td><p>Test whether Y conditioned on X is invariant across the groups.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="pywhy_stats.conditional_ksample.kcd.condind">
<span class="sig-name descname"><span class="pre">condind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_ind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pywhy_stats/conditional_ksample/kcd.html#condind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pywhy_stats.conditional_ksample.kcd.condind" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether Y conditioned on X is invariant across the groups.</p>
<p>For testing conditional independence on continuous data, we leverage kernels
<a class="footnote-reference brackets" href="#footcite-zhang2011" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> that are computationally efficient. This specifically
tests the (conditional) invariance null hypothesis :math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P_</span><span class="p">{</span><span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">}(</span><span class="n">Y</span><span class="o">|</span><span class="n">X</span><span class="p">)</span> <span class="o">=</span> <span class="n">P_</span><span class="p">{</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">}(</span><span class="n">Y</span><span class="o">|</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a> of shape (n_samples, n_features_x)</span></dt><dd><p>Data for variable X, which can be multidimensional.</p>
</dd>
<dt><strong>Y</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a> of shape (n_samples, n_features_y)</span></dt><dd><p>Data for variable Y, which can be multidimensional.</p>
</dd>
<dt><strong>group_ind</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a> of shape (n_samples,)</span></dt><dd><p>Data for group indicator Z, which can be multidimensional. This assigns each sample
to a group indicated by 0 or 1.</p>
</dd>
<dt><strong>kernel_X</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Callable</span></code>[[<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a>], <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a>]</span></dt><dd><p>The kernel function for X. By default, the RBF kernel is used for continuous and the delta
kernel for categorical data. Note that we currently only consider string values as categorical data.
Kernels can be specified in the same way as for <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.pairwise_kernels.html#sklearn.metrics.pairwise.pairwise_kernels" title="(in scikit-learn v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pairwise_kernels()</span></code></a>
with the addition that ‘delta’ kernel is supported for categorical data.</p>
</dd>
<dt><strong>kernel_Y</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Callable</span></code>[[<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a>], <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a>]</span></dt><dd><p>The kernel function for Y. By default, the RBF kernel is used for continuous and the delta
kernel for categorical data. Note that we currently only consider string values as categorical data.
Kernels can be specified in the same way as for <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.pairwise_kernels.html#sklearn.metrics.pairwise.pairwise_kernels" title="(in scikit-learn v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pairwise_kernels()</span></code></a>
with the addition that ‘delta’ kernel is supported for categorical data.</p>
</dd>
<dt><strong>null_sample_size</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of samples to generate for the bootstrap distribution to approximate the pvalue,
by default 1000.</p>
</dd>
<dt><strong>normalize_data</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.11)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>Whether the data should be standardized to unit variance, by default True.</p>
</dd>
<dt><strong>propensity_model</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator" title="(in scikit-learn v1.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code></a>], optional</span></dt><dd><p>The propensity model to use to estimate the propensity score, by default None.</p>
</dd>
<dt><strong>propensity_weights</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.25)"><span class="xref std std-term">array_like</span></a>], optional</span></dt><dd><p>The propensity weights to use, by default None, which means that the propensity scores
will be estimated from the propensity_model.</p>
</dd>
<dt><strong>centered</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.11)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>Whether the kernel matrix should be centered, by default True.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>], optional</span></dt><dd><p>The number of jobs to run in parallel, by default None.</p>
</dd>
<dt><strong>random_seed</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>], optional</span></dt><dd><p>Random seed, by default None.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Any callable can be given to create the kernel matrix. For instance, to use a particular kernel
from sklearn:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>kernel_X = func:`sklearn.metrics.pairwise.pairwise_kernels.polynomial`
</pre></div>
</div>
<p>In addition, we implement an efficient delta kernel. The delta kernel can be specified using the
‘kernel’ string argument.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id2">
<aside class="footnote brackets" id="footcite-zhang2011" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Kun Zhang, Jonas Peters, Dominik Janzing, and Bernhard Schölkopf. Kernel-based conditional independence test and application in causal discovery. In <em>Proceedings of the Twenty-Seventh Conference on Uncertainty in Artificial Intelligence</em>, UAI’11, 804–813. Arlington, Virginia, USA, 2011. AUAI Press.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="pywhy_stats.conditional_ksample.bregman.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title"><span class="section-number">2.3.1. </span>pywhy_stats.conditional_ksample.bregman</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="../use.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Examples and Tutorials using pywhy-stats</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2023, PyWhy.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>